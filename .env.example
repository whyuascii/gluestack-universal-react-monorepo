# =============================================================================
# ENVIRONMENT CONFIGURATION
# =============================================================================
# This is the single source of truth for all environment variables.
#
# SETUP:
#   1. Copy this file to .env: cp .env.example .env
#   2. Fill in the REQUIRED values (marked with [REQUIRED])
#   3. Configure OPTIONAL values as needed for your features
#
# ENVIRONMENTS:
#   - See config/env.development.example for local development defaults
#   - See config/env.production.example for production checklist
#
# VALIDATION:
#   Run `pnpm env:check` to validate your configuration
# =============================================================================


# =============================================================================
# CORE SETTINGS [REQUIRED]
# These must be configured for the app to run
# =============================================================================

# -----------------------------------------------------------------------------
# Database [REQUIRED]
# -----------------------------------------------------------------------------
# PostgreSQL connection string
#
# Local Development Options:
#   - Supabase Local: postgresql://postgres:postgres@127.0.0.1:54322/postgres
#   - Docker:         postgresql://postgres:postgres@localhost:5432/myapp
#   - Neon:           postgresql://user:pass@ep-xxx.region.aws.neon.tech/dbname
#
# Production: Use your cloud provider's connection string
DATABASE_URL=postgresql://postgres:postgres@127.0.0.1:54322/postgres

# -----------------------------------------------------------------------------
# Authentication [REQUIRED]
# -----------------------------------------------------------------------------
# Better Auth secret key - MUST be at least 32 characters
# Generate with: openssl rand -base64 32
# SECURITY: This key is used for:
#   - Signing session tokens
#   - Encrypting JWT private keys
#   - Cookie encryption (JWE strategy)
BETTER_AUTH_SECRET=your-secret-key-change-me-in-production-min-32-chars

# The URL where your API server runs (where Better Auth is mounted)
# Development: http://localhost:3030
# Production:  https://api.yourdomain.com
BETTER_AUTH_URL=http://localhost:3030

# -----------------------------------------------------------------------------
# Authentication Security (Pre-configured in code)
# -----------------------------------------------------------------------------
# The following security features are enabled by default in packages/auth/src/config.ts:
#
# SESSION SECURITY (Refresh Token Rotation):
#   - Sessions expire after 7 days of inactivity
#   - Sessions are "rotated" (refreshed) every 24 hours when active
#   - Old session tokens become invalid after rotation (prevents replay attacks)
#   - Sensitive operations require "fresh" sessions (created within 10 minutes)
#   - Cookie caching with JWE encryption in production
#
# JWT TOKENS (For API/Service Authentication):
#   - Short-lived tokens (15 minutes) requiring refresh
#   - Automatic key rotation every 30 days
#   - 7-day grace period for old keys after rotation
#   - Minimal payload (sub, email, emailVerified) for security
#
# BEARER TOKENS (For Mobile/CLI Authentication):
#   - Signed tokens required in production
#   - Can be used instead of cookies for API requests
#
# RATE LIMITING:
#   - 100 requests per minute (general)
#   - 10 requests per minute for auth endpoints (sign-in, sign-up)
#   - 5 requests per minute for password reset
#
# To customize these settings, edit: packages/auth/src/config.ts

# -----------------------------------------------------------------------------
# API Server [REQUIRED]
# -----------------------------------------------------------------------------
# Port and host for the API server
PORT=3030
HOST=0.0.0.0

# API server URL - used by web and mobile clients
NEXT_PUBLIC_API_URL=http://localhost:3030
EXPO_PUBLIC_API_URL=http://localhost:3030

# Web app URL - used for redirects, emails, CORS
NEXT_PUBLIC_APP_URL=http://localhost:3000

# Rate Limiting (optional - has sensible defaults)
# Maximum requests per window (default: 100)
# RATE_LIMIT_MAX=100
# Time window in milliseconds (default: 60000 = 1 minute)
# RATE_LIMIT_WINDOW_MS=60000

# -----------------------------------------------------------------------------
# Security / CORS [REQUIRED]
# -----------------------------------------------------------------------------
# Comma-separated list of allowed origins for CORS and auth
# Include all client URLs (web, mobile dev servers)
#
# Development: http://localhost:3000,http://localhost:8081,http://localhost:19006
# Production:  https://yourdomain.com,https://www.yourdomain.com
TRUSTED_ORIGINS=http://localhost:3000,http://localhost:8081,http://localhost:19006
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:8081,http://localhost:19006


# =============================================================================
# EMAIL [REQUIRED for auth emails]
# Transactional emails via Resend
# =============================================================================

# Resend API Key
# Get from: https://resend.com/api-keys
RESEND_API_KEY=re_your_api_key_here

# App branding
APP_NAME=My App
NEXT_PUBLIC_APP_NAME=My App

# Sender information
EMAIL_FROM_NAME=Your App Name
EMAIL_FROM_ADDRESS=noreply@yourdomain.com
EMAIL_REPLY_TO=support@yourdomain.com


# =============================================================================
# OAUTH PROVIDERS [OPTIONAL]
# Social login - configure the ones you need
# =============================================================================

# Google OAuth
# Setup: https://console.cloud.google.com/apis/credentials
# Callback URL: {BETTER_AUTH_URL}/api/auth/callback/google
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=

# GitHub OAuth
# Setup: https://github.com/settings/developers
# Callback URL: {BETTER_AUTH_URL}/api/auth/callback/github
GITHUB_CLIENT_ID=
GITHUB_CLIENT_SECRET=

# Apple OAuth (for mobile)
# Setup: https://developer.apple.com/account/resources/identifiers
# APPLE_CLIENT_ID=
# APPLE_CLIENT_SECRET=
# APPLE_TEAM_ID=
# APPLE_KEY_ID=


# =============================================================================
# ANALYTICS [OPTIONAL]
# PostHog product analytics + OTEL logging
# =============================================================================

# PostHog Configuration
# Get from: https://app.posthog.com/project/settings
#
# Web + API (NEXT_PUBLIC_ exposes to browser, API uses same key)
NEXT_PUBLIC_POSTHOG_KEY=
NEXT_PUBLIC_POSTHOG_HOST=https://us.i.posthog.com

# Mobile (Expo requires EXPO_PUBLIC_ prefix)
EXPO_PUBLIC_POSTHOG_KEY=
EXPO_PUBLIC_POSTHOG_HOST=https://us.i.posthog.com

# API Server (server-side analytics)
POSTHOG_KEY=
POSTHOG_HOST=https://us.i.posthog.com

# OTEL Logging - sends WARN/ERROR logs to PostHog Logs
# Set to "true" to enable in development (always enabled in production)
POSTHOG_LOGS_ENABLED=false


# =============================================================================
# PUSH NOTIFICATIONS [OPTIONAL]
# Novu for in-app notifications, Expo Push for mobile (NOT for email - use Resend above)
# =============================================================================

# Novu Configuration
# Get from: https://dashboard.novu.co > Settings > API Keys
# Application Identifier (same for all platforms)
NOVU_SECRET_KEY=
NOVU_APP_ID=CbkXcUBSVrSx
NEXT_PUBLIC_NOVU_APP_ID=CbkXcUBSVrSx
EXPO_PUBLIC_NOVU_APP_ID=CbkXcUBSVrSx


# =============================================================================
# SUBSCRIPTIONS / PAYMENTS [OPTIONAL]
# RevenueCat for cross-platform subscriptions
# =============================================================================

# IMPORTANT: RevenueCat requires SEPARATE API keys per platform
# Each platform connects to a different app store
# Get from: https://app.revenuecat.com > Project > API Keys

# Web (Stripe payments) - Public API Key
NEXT_PUBLIC_REVENUECAT_API_KEY=

# iOS (Apple App Store) - Public Apple API Key
EXPO_PUBLIC_REVENUECAT_API_KEY_IOS=

# Android (Google Play Store) - Public Google API Key
EXPO_PUBLIC_REVENUECAT_API_KEY_ANDROID=

# Entitlement & Product IDs (must match RevenueCat dashboard)
# These are typically the same across platforms
NEXT_PUBLIC_REVENUECAT_ENTITLEMENT_PREMIUM=premium
EXPO_PUBLIC_REVENUECAT_ENTITLEMENT_PREMIUM=premium
NEXT_PUBLIC_REVENUECAT_PRODUCT_MONTHLY=monthly
EXPO_PUBLIC_REVENUECAT_PRODUCT_MONTHLY=monthly
NEXT_PUBLIC_REVENUECAT_PRODUCT_YEARLY=yearly
EXPO_PUBLIC_REVENUECAT_PRODUCT_YEARLY=yearly
NEXT_PUBLIC_REVENUECAT_DEFAULT_OFFERING=default
EXPO_PUBLIC_REVENUECAT_DEFAULT_OFFERING=default


# =============================================================================
# ADVERTISING [OPTIONAL]
# Google AdMob for mobile, AdSense for web
# =============================================================================

# -----------------------------------------------------------------------------
# Ads Enable/Disable (per app)
# -----------------------------------------------------------------------------
# Set to "true" to enable ads, "false" to disable
# Ads will only show if enabled AND ad IDs are configured
EXPO_PUBLIC_ADS_ENABLED=false
NEXT_PUBLIC_ADS_ENABLED=false

# -----------------------------------------------------------------------------
# Mobile Ads - Google AdMob
# -----------------------------------------------------------------------------
# Get from: https://admob.google.com/home/ > Apps

# AdMob App IDs (required for native builds)
EXPO_PUBLIC_ADMOB_ANDROID_APP_ID=
EXPO_PUBLIC_ADMOB_IOS_APP_ID=

# Banner Ad Unit IDs
EXPO_PUBLIC_ADMOB_ANDROID_BANNER_ID=
EXPO_PUBLIC_ADMOB_IOS_BANNER_ID=

# Interstitial Ad Unit IDs (optional - for full-screen ads)
EXPO_PUBLIC_ADMOB_ANDROID_INTERSTITIAL_ID=
EXPO_PUBLIC_ADMOB_IOS_INTERSTITIAL_ID=

# Rewarded Ad Unit IDs (optional - for rewarded video ads)
EXPO_PUBLIC_ADMOB_ANDROID_REWARDED_ID=
EXPO_PUBLIC_ADMOB_IOS_REWARDED_ID=

# Test Device IDs (comma-separated)
# Required for testing ads without violating AdMob policies
# To find your device ID:
#   1. Run app with ads enabled
#   2. Check logs for "Use RequestConfiguration.Builder.setTestDeviceIds"
#   3. Copy the device ID and add it here
EXPO_PUBLIC_ADMOB_TEST_DEVICE_IDS=

# -----------------------------------------------------------------------------
# Web Ads - Google AdSense
# -----------------------------------------------------------------------------
# Get from: https://www.google.com/adsense/

# AdSense Publisher ID (format: ca-pub-XXXXXXXXXXXXXXXX)
NEXT_PUBLIC_ADSENSE_CLIENT_ID=

# Ad Slot ID for banner ads
NEXT_PUBLIC_ADSENSE_BANNER_SLOT_ID=


# =============================================================================
# ENVIRONMENT & DEBUG
# =============================================================================

# Environment stage
# Values: local, development, staging, production
NODE_ENV=development
ENVIRONMENT_STAGE=local

# Demo mode (optional) - enables demo features without real backend
# EXPO_PUBLIC_DEMO_MODE=false

# Build info (typically set by CI/CD, not manually)
# GIT_BRANCH=main
# GIT_HASH=abc123

# Infrastructure (if using AWS)
# AWS_REGION=us-east-1


# =============================================================================
# QUICK REFERENCE: Which services need which variables?
# =============================================================================
#
# To run locally (minimum):
#   - DATABASE_URL
#   - BETTER_AUTH_SECRET
#   - BETTER_AUTH_URL
#   - NEXT_PUBLIC_API_URL / EXPO_PUBLIC_API_URL
#   - NEXT_PUBLIC_APP_URL
#   - TRUSTED_ORIGINS / ALLOWED_ORIGINS
#   - RESEND_API_KEY (for auth emails)
#   - EMAIL_FROM_* variables
#
# To enable analytics:
#   - NEXT_PUBLIC_POSTHOG_* (Web + API)
#   - EXPO_PUBLIC_POSTHOG_* (Mobile)
#   - POSTHOG_KEY + POSTHOG_HOST (API server)
#   - POSTHOG_LOGS_ENABLED=true (to enable OTEL logs in dev)
#
# To enable push notifications:
#   - NOVU_SECRET_KEY + NOVU_APP_ID (API)
#   - NEXT_PUBLIC_NOVU_APP_ID (Web)
#   - EXPO_PUBLIC_NOVU_APP_ID (Mobile)
#
# To enable subscriptions:
#   - NEXT_PUBLIC_REVENUECAT_API_KEY (Web)
#   - EXPO_PUBLIC_REVENUECAT_API_KEY_IOS (iOS)
#   - EXPO_PUBLIC_REVENUECAT_API_KEY_ANDROID (Android)
#   - *_REVENUECAT_ENTITLEMENT_* and *_REVENUECAT_PRODUCT_*
#
# To enable social login:
#   - GOOGLE_CLIENT_ID + GOOGLE_CLIENT_SECRET (Google)
#   - GITHUB_CLIENT_ID + GITHUB_CLIENT_SECRET (GitHub)
#
# To enable mobile ads:
#   - EXPO_PUBLIC_ADS_ENABLED=true
#   - EXPO_PUBLIC_ADMOB_ANDROID_APP_ID (Android)
#   - EXPO_PUBLIC_ADMOB_IOS_APP_ID (iOS)
#   - EXPO_PUBLIC_ADMOB_*_BANNER_ID, *_INTERSTITIAL_ID, *_REWARDED_ID
#
# To enable web ads:
#   - NEXT_PUBLIC_ADS_ENABLED=true
#   - NEXT_PUBLIC_ADSENSE_CLIENT_ID
#   - NEXT_PUBLIC_ADSENSE_BANNER_SLOT_ID
#
# =============================================================================
