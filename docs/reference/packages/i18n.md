# i18n Package

Internationalization (i18n) support using i18next with English and Spanish translations.

## Overview

The `i18n` package provides multi-language support for web and mobile applications with platform-specific configurations.

**Package:** `packages/i18n`

**Supported Languages:**

- üá∫üá∏ English (`en`)
- üá™üá∏ Spanish (`es`)

**Platform Support:**

- ‚úÖ Web (Next.js) - `i18n/web`
- ‚úÖ Mobile (React Native) - `i18n/mobile`

---

## Installation

Already included in the monorepo. Apps import platform-specific modules:

```typescript
// Web
import { useTranslation } from "@app/i18n/web";

// Mobile
import { useTranslation } from "@app/i18n/mobile";
```

---

## Exports

### useTranslation

React hook for accessing translations.

**Returns:**

- `t` - Translation function
- `i18n` - i18next instance

**Example:**

```typescript
import { useTranslation } from "@app/i18n/web";

function MyComponent() {
  const { t, i18n } = useTranslation();

  return (
    <div>
      <h1>{t("common.welcome")}</h1>
      <p>{t("common.description")}</p>
    </div>
  );
}
```

---

## Translation Structure

Translations are organized by domain in `packages/i18n/src/locales/`:

```
locales/
‚îú‚îÄ‚îÄ en/
‚îÇ   ‚îú‚îÄ‚îÄ common.json       # Common UI strings
‚îÇ   ‚îú‚îÄ‚îÄ auth.json         # Authentication
‚îÇ   ‚îî‚îÄ‚îÄ validation.json   # Form validation
‚îî‚îÄ‚îÄ es/
    ‚îú‚îÄ‚îÄ common.json
    ‚îú‚îÄ‚îÄ auth.json
    ‚îî‚îÄ‚îÄ validation.json
```

### Translation Files

**`common.json`** - UI elements, navigation, general text

```json
{
  "welcome": "Welcome",
  "getStarted": "Get Started",
  "loading": "Loading...",
  "error": "An error occurred",
  "buttons": {
    "save": "Save",
    "cancel": "Cancel",
    "delete": "Delete"
  }
}
```

**`auth.json`** - Authentication flows

```json
{
  "signIn": "Sign In",
  "signUp": "Sign Up",
  "signOut": "Sign Out",
  "email": "Email",
  "password": "Password",
  "forgotPassword": "Forgot Password?",
  "createAccount": "Create Account"
}
```

**`validation.json`** - Validation messages

```json
{
  "required": "This field is required",
  "invalidEmail": "Invalid email address",
  "passwordTooShort": "Password must be at least 8 characters",
  "passwordsDoNotMatch": "Passwords do not match"
}
```

---

## Usage

### Basic Translation

```typescript
import { useTranslation } from "@app/i18n/web";

function Header() {
  const { t } = useTranslation();

  return (
    <nav>
      <a href="/">{t("common.home")}</a>
      <a href="/about">{t("common.about")}</a>
      <a href="/contact">{t("common.contact")}</a>
    </nav>
  );
}
```

### Nested Keys

```typescript
const { t } = useTranslation();

// Access nested translations
<button>{t("common.buttons.save")}</button>
<button>{t("common.buttons.cancel")}</button>
```

### Interpolation

```json
{
  "welcome": "Welcome, {{name}}!",
  "itemCount": "You have {{count}} items"
}
```

```typescript
<h1>{t("common.welcome", { name: user.name })}</h1>
<p>{t("common.itemCount", { count: items.length })}</p>
```

### Pluralization

```json
{
  "item": "item",
  "item_one": "{{count}} item",
  "item_other": "{{count}} items"
}
```

```typescript
// Automatically selects singular/plural
<span>{t("common.item", { count: 1 })}</span>  // "1 item"
<span>{t("common.item", { count: 5 })}</span>  // "5 items"
```

---

## Language Switching

### Change Language

```typescript
import { useTranslation } from "@app/i18n/web";

function LanguageSwitcher() {
  const { i18n } = useTranslation();

  return (
    <div>
      <button onClick={() => i18n.changeLanguage("en")}>
        English
      </button>
      <button onClick={() => i18n.changeLanguage("es")}>
        Espa√±ol
      </button>
    </div>
  );
}
```

### Get Current Language

```typescript
const { i18n } = useTranslation();

console.log(i18n.language); // "en" or "es"
```

### Detect Language Change

```typescript
import { useEffect } from "react";

function LanguageAware() {
  const { i18n } = useTranslation();

  useEffect(() => {
    const handleLanguageChange = (lng: string) => {
      console.log("Language changed to:", lng);
    };

    i18n.on("languageChanged", handleLanguageChange);

    return () => {
      i18n.off("languageChanged", handleLanguageChange);
    };
  }, [i18n]);
}
```

---

## Platform Differences

### Web Configuration

**Location:** `packages/i18n/src/i18n.web.ts`

**Features:**

- Browser language detection
- LocalStorage persistence
- SSR support (Next.js)

**Language Detection Order:**

1. Previously selected language (localStorage)
2. Browser language
3. Default language (`en`)

### Mobile Configuration

**Location:** `packages/i18n/src/i18n.mobile.ts`

**Features:**

- Device language detection
- AsyncStorage persistence
- Expo Localization integration

**Language Detection Order:**

1. Previously selected language (AsyncStorage)
2. Device language (from Expo)
3. Default language (`en`)

---

## Advanced Usage

### Format Dates

```typescript
import { useTranslation } from "@app/i18n/web";

function DateDisplay({ date }) {
  const { i18n } = useTranslation();

  return (
    <span>
      {new Intl.DateTimeFormat(i18n.language).format(date)}
    </span>
  );
}
```

### Format Numbers

```typescript
function PriceDisplay({ amount }) {
  const { i18n } = useTranslation();

  return (
    <span>
      {new Intl.NumberFormat(i18n.language, {
        style: "currency",
        currency: "USD",
      }).format(amount)}
    </span>
  );
}
```

### Namespace-Specific Hook

```typescript
// Only load auth translations
const { t } = useTranslation("auth");

<h1>{t("signIn")}</h1>  // From auth.json
```

### Multiple Namespaces

```typescript
const { t } = useTranslation(["common", "auth"]);

<h1>{t("common:welcome")}</h1>
<button>{t("auth:signIn")}</button>
```

---

## Adding New Translations

### 1. Add to Translation Files

**`packages/i18n/src/locales/en/common.json`:**

```json
{
  "newFeature": {
    "title": "New Feature",
    "description": "Check out our new feature!"
  }
}
```

**`packages/i18n/src/locales/es/common.json`:**

```json
{
  "newFeature": {
    "title": "Nueva Funci√≥n",
    "description": "¬°Mira nuestra nueva funci√≥n!"
  }
}
```

### 2. Use in Components

```typescript
const { t } = useTranslation();

<div>
  <h2>{t("common.newFeature.title")}</h2>
  <p>{t("common.newFeature.description")}</p>
</div>
```

---

## Adding New Languages

### 1. Create Translation Files

```bash
mkdir -p packages/i18n/src/locales/fr
cp packages/i18n/src/locales/en/*.json packages/i18n/src/locales/fr/
```

### 2. Translate Content

Edit `packages/i18n/src/locales/fr/*.json` with French translations.

### 3. Update Configuration

**Web** (`packages/i18n/src/i18n.web.ts`):

```typescript
i18n.use(initReactI18next).init({
  resources: {
    en: {
      /* ... */
    },
    es: {
      /* ... */
    },
    fr: {
      // Add French
      common: commonFr,
      auth: authFr,
      validation: validationFr,
    },
  },
  fallbackLng: "en",
  supportedLngs: ["en", "es", "fr"], // Add to supported
});
```

### 4. Update Language Switcher

```typescript
<button onClick={() => i18n.changeLanguage("fr")}>
  Fran√ßais
</button>
```

---

## Best Practices

### Translation Keys

**DO:**

- ‚úÖ Use descriptive keys: `auth.signIn`, `common.buttons.save`
- ‚úÖ Group related translations: `common.buttons.*`, `auth.errors.*`
- ‚úÖ Use camelCase for keys: `emailAddress`, `passwordReset`

**DON'T:**

- ‚ùå Use sentences as keys: `"Sign In"` ‚Üê use `auth.signIn`
- ‚ùå Duplicate keys across files
- ‚ùå Use generic keys: `text1`, `label2`

### Translation Content

**DO:**

- ‚úÖ Keep translations concise
- ‚úÖ Use interpolation for dynamic content
- ‚úÖ Consider cultural differences
- ‚úÖ Use proper punctuation for each language

**DON'T:**

- ‚ùå Hardcode English in components
- ‚ùå Concatenate translated strings
- ‚ùå Assume word order is the same across languages

### Organization

**DO:**

- ‚úÖ Organize by feature/domain
- ‚úÖ Keep common UI strings in `common.json`
- ‚úÖ Create new files for large feature areas
- ‚úÖ Keep parallel structure across languages

**DON'T:**

- ‚ùå Put everything in one file
- ‚ùå Mix different domains in same file
- ‚ùå Create files that only have 2-3 keys

---

## Debugging

### Missing Translation Keys

i18next logs missing keys in development:

```
i18next::translator: missingKey en common newKey
```

### Show Translation Keys

```typescript
// In development, show keys instead of translations
if (process.env.NODE_ENV === "development") {
  i18n.init({
    // ...
    saveMissing: true,
    debug: true,
  });
}
```

### Check All Keys

```bash
# Find all translation usage
grep -r "t(\"" apps/ packages/
grep -r "t('" apps/ packages/
```

---

## Common Patterns

### Loading States

```typescript
const { t } = useTranslation();

{loading && <p>{t("common.loading")}</p>}
{error && <p>{t("common.error")}</p>}
```

### Form Labels

```typescript
<Input
  label={t("auth.email")}
  placeholder={t("auth.emailPlaceholder")}
  error={errors.email && t("validation.invalidEmail")}
/>
```

### Confirmation Dialogs

```typescript
const confirmDelete = () => {
  if (confirm(t("common.confirmDelete", { name: item.name }))) {
    deleteItem(item.id);
  }
};
```

### Dynamic Content

```typescript
// Translation with variables
<p>
  {t("dashboard.greeting", {
    name: user.name,
    itemCount: items.length,
  })}
</p>
```

---

## Type Safety

### Typed Translation Keys

For type-safe translation keys, you can generate types:

```typescript
// types/i18n.d.ts
import "i18next";
import common from "../packages/i18n/src/locales/en/common.json";
import auth from "../packages/i18n/src/locales/en/auth.json";

declare module "i18next" {
  interface CustomTypeOptions {
    resources: {
      common: typeof common;
      auth: typeof auth;
    };
  }
}
```

Now TypeScript will autocomplete translation keys!

---

## Related Documentation

- **[Internationalization Guide](../../guides/features/internationalization.md)** - Setup and implementation
- **[i18next Documentation](https://www.i18next.com/)** - Official i18next docs
- **[React i18next](https://react.i18next.com/)** - React integration
